<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Dynamicloaderdex : DynamicLoaderDEX">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Dynamicloaderdex</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/frankjunqi/DynamicLoaderDEX">View on GitHub</a>

          <h1 id="project_title">Dynamicloaderdex</h1>
          <h2 id="project_tagline">DynamicLoaderDEX</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/frankjunqi/DynamicLoaderDEX/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/frankjunqi/DynamicLoaderDEX/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="dynamicloaderdex" class="anchor" href="#dynamicloaderdex" aria-hidden="true"><span class="octicon octicon-link"></span></a>DynamicLoaderDEX</h1>

<p>DynamicLoaderDEX项目希望能帮助到广大的Android开发者运用到自己钟爱的项目中。</p>

<h1>
<a id="背景" class="anchor" href="#%E8%83%8C%E6%99%AF" aria-hidden="true"><span class="octicon octicon-link"></span></a>背景</h1>

<ol>
<li>Android中每个dex有最多65536方法数的限制；</li>
<li>在Android的新版本中已经做了改善，但是兼容老版本需要做处理；</li>
<li>项目的功能不断增加，方法数，以及jar的数量增加；</li>
</ol>

<h1>
<a id="解决方案" class="anchor" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" aria-hidden="true"><span class="octicon octicon-link"></span></a>解决方案</h1>

<ol>
<li>使用ProGuard；</li>
<li>使用多个dex，动态反射加载；</li>
<li>通过JNI替换记录方法信息的缓存（Facebook），这个是从根本上解决问题，但是需要兼容各大手机厂商，难度很大；</li>
</ol>

<h1>
<a id="dex动态加载" class="anchor" href="#dex%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD" aria-hidden="true"><span class="octicon octicon-link"></span></a>dex动态加载</h1>

<p>dx命令(dex) --- DexClassLoader加载dex --- 反射调用</p>

<h1>
<a id="dx命令使用" class="anchor" href="#dx%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>dx命令使用</h1>

<ol>
<li>配置环境变量：Androidsdk中的sdk\build-tools\19.0.2中的dx.bat</li>
<li>dx --dex --output="地址一" “地址二”：
a. 地址一是输出的文件;b. 地址二是源jar包地址 可以用*.jar这样的形式处理目录里的所有文件;</li>
</ol>

<h1>
<a id="dexclassloader加载dex" class="anchor" href="#dexclassloader%E5%8A%A0%E8%BD%BDdex" aria-hidden="true"><span class="octicon octicon-link"></span></a>DexClassLoader加载dex</h1>

<ol>
<li>com.frank.dynamicloaderdex.proxy包中ExlibAsyncLoader、Module、ModuleLoader、MultiDex是动态加载的框架；</li>
<li>com.frank.dynamicloaderdex.proxy.gson是需要通过dex动态加载反射的方法和类；</li>
<li>BaseApplication中attachBaseContext()方法中进行同步加载dex，也可以在这里进行异步加载dex；</li>
<li>在AndroidManifest.xml中Application中的指定自己的application，这样动态的dex才可以被加载；</li>
</ol>

<h1>
<a id="统计项目中方法数工具" class="anchor" href="#%E7%BB%9F%E8%AE%A1%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%96%B9%E6%B3%95%E6%95%B0%E5%B7%A5%E5%85%B7" aria-hidden="true"><span class="octicon octicon-link"></span></a>统计项目中方法数工具</h1>

<p><a href="https://github.com/mihaip/dex-method-counts">https://github.com/mihaip/dex-method-counts</a></p>

<h1>
<a id="背景参考文献" class="anchor" href="#%E8%83%8C%E6%99%AF%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE" aria-hidden="true"><span class="octicon octicon-link"></span></a>背景参考文献</h1>

<ol>
<li><a href="https://medium.com/@rotxed/dex-skys-the-limit-no-65k-methods-is-28e6cb40cf71">https://medium.com/@rotxed/dex-skys-the-limit-no-65k-methods-is-28e6cb40cf71</a></li>
<li><a href="http://blog.csdn.net/ddaitest/article/details/21020511">http://blog.csdn.net/ddaitest/article/details/21020511</a></li>
<li><a href="http://viila.info/2014/04/android-2-3-dex-max-function-problem/">http://viila.info/2014/04/android-2-3-dex-max-function-problem/</a></li>
</ol>

<h1>
<a id="动态加载参考文献" class="anchor" href="#%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE" aria-hidden="true"><span class="octicon octicon-link"></span></a>动态加载参考文献</h1>

<p><a href="http://android-developers.blogspot.co.il/2011/07/custom-class-loading-in-dalvik.html?m=1">http://android-developers.blogspot.co.il/2011/07/custom-class-loading-in-dalvik.html?m=1</a></p>

<h1>
<a id="dx命令参考文献" class="anchor" href="#dx%E5%91%BD%E4%BB%A4%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE" aria-hidden="true"><span class="octicon octicon-link"></span></a>dx命令参考文献</h1>

<p><a href="http://www.cnblogs.com/wujd/archive/2012/01/10/wujiandong-android-1.html">http://www.cnblogs.com/wujd/archive/2012/01/10/wujiandong-android-1.html</a></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Dynamicloaderdex maintained by <a href="https://github.com/frankjunqi">frankjunqi</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
